# ðŸ”– Linear Regression {#lr}

<script src="files/js/dcl.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"> </script>

<script src="files/js/dcl.js"></script>
```{r ,include=FALSE}
tutorial::go_interactive(greedy=TRUE)
knitr::opts_chunk$set(echo = TRUE,error=TRUE)
```

- **Lecture slides: **     <button class="btn btn-primary" data-toggle="collapse" data-target="#lr12"> Linear Regression </button> 
<div id="lr12" class="collapse">
<embed src="https://docs.google.com/presentation/d/1RuAidmZGDoTRYMjONLEsw3bfx_aQb-f3C0V4Jjk4Vzs/edit?usp=sharing" width="100%" height="500px"></embed>
</div>

## Snippet 1: How much do Midterm, Project and Final Exam count?

```{r,tut=TRUE,height=500}
moodyNUM<-read.csv('https://raw.githubusercontent.com/dev7796/data101_tutorial/main/files/dataset/MoodyNUM.csv')
split<-0.7*nrow(moodyNUM)
split
moodyNUMTr<-moodyNUM[1:split,]
moodyNUMTr
moodyNUMTs<-moodyNUM[split:nrow(moodyNUM),]
#We use linear regression to #find out the weights of #Midterm, Project and Final #Exam in calculation of the #final class score. Each of #them are scored out of 100 and #the final class score is also #scored out of 100 as weighted #sum of Midterm, Project and #Final Exam scores.
train <- lm(ClassScore~.,  data=moodyNUMTr)
train
pred <- predict(train,newdata=moodyNUMTs)
mean((pred - moodyNUMTs$ClassScore)^2)
```

## Snippet 2: Cross Validate your prediction

```{r,tut=TRUE,height=600}
train <- read.csv("https://raw.githubusercontent.com/dev7796/data101_tutorial/main/files/dataset/MoodyNUM.csv")
#scramble the train frame
v<-sample(1:nrow(train))
v[1:5]
trainScrambled<-train[v, ]

#one step crossvalidation
n <- 100
trainSample<-trainScrambled[nrow(trainScrambled)-n:nrow(trainScrambled), ]
testSample <- trainScrambled[1:n,]

lm.tree <- lm(ClassScore~.,  data=trainSample)
lm.tree

pred <- predict(lm.tree,newdata=testSample)
pred

mse <- mean((pred - testSample$ClassScore)^2)
mse

  
```

## Snippet 3: Submission with lm

```{r,tut=TRUE,height=600}
library(rpart)
test<-read.csv('https://raw.githubusercontent.com/dev7796/data101_tutorial/main/files/dataset/MoodyNUM_test.csv')
submission<-read.csv('https://raw.githubusercontent.com/dev7796/data101_tutorial/main/files/dataset/M2022submission.csv')
train <- read.csv("https://raw.githubusercontent.com/dev7796/data101_tutorial/main/files/dataset/MoodyNUM.csv")

tree <- lm(ClassScore~.,  data=train)
tree

prediction <- predict(tree, newdata=test)

#Now make your submission file - it will have the IDs and now the predicted grades
submission$Grade<-prediction 

# use write.csv(submission, 'submission.csv', row.names=FALSE) to store submission as csv file on your machine and subsequently submit it on Kaggle
```